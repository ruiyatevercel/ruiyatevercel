<!-- å…¶ä»–ä»£ç ä¸å˜ï¼Œåªæ”¹JSéƒ¨åˆ†çš„fetchè·¯å¾„ -->
<script>
    document.getElementById('loginForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        const password = document.getElementById('password').value;
        const loginBtn = document.getElementById('loginBtn');
        const messageDiv = document.getElementById('loginMessage');
        
        messageDiv.innerHTML = '';
        messageDiv.className = '';
        
        if (!password) {
            messageDiv.innerHTML = 'è¯·è¾“å…¥å¯†ç ';
            messageDiv.className = 'error';
            return;
        }
        
        loginBtn.disabled = true;
        loginBtn.textContent = 'éªŒè¯ä¸­...';
        messageDiv.innerHTML = 'æ­£åœ¨éªŒè¯èº«ä»½...';
        messageDiv.className = 'loading';
        
        try {
            // ğŸ‘‡ æ”¹æˆ Vercel çš„ API è·¯å¾„
            const response = await fetch('/api/login', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ password: password })
            });
            
            const data = await response.json();
            
            if (data.success) {
                messageDiv.innerHTML = 'éªŒè¯æˆåŠŸï¼æ­£åœ¨è·³è½¬...';
                messageDiv.className = 'success';
                localStorage.setItem('cipherlab_logged_in', 'true');
                setTimeout(() => {
                    window.location.href = 'decoder.html';
                }, 1000);
            } else {
                messageDiv.innerHTML = data.message || 'å¯†ç é”™è¯¯';
                messageDiv.className = 'error';
                loginBtn.disabled = false;
                loginBtn.textContent = 'ç™»å½•éªŒè¯';
            }
        } catch (error) {
            messageDiv.innerHTML = 'ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•';
            messageDiv.className = 'error';
            loginBtn.disabled = false;
            loginBtn.textContent = 'ç™»å½•éªŒè¯';
        }
    });
</script>
